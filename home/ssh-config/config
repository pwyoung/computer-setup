#UserKnownHostsFile /dev/null
#StrictHostKeyChecking no

# "SSH Jump-Box"
Host jb
  HostName 34.229.247.14
  User ubuntu
  Port 22
  LogLevel FATAL
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
  IdentitiesOnly yes
  IdentityFile ~/.ssh/id_ed25519-devops
  # Forward my SSH keys into the session so I can SSH to another host
  ForwardAgent yes
#
# SSH-ProxyCommand
#   Jump through the "SSH Jump-Box" to this machine
#   This uses SSH ProxyCommand to allow the ssh cli
#   to appear as though its a direct connection.
# Test with: "ssh jt hostname"
Host jt
  HostName 10.0.1.26
  IdentityFile ~/.ssh/id_ed25519-devops
  IdentitiesOnly yes
  Port 22
  User ubuntu
  ProxyCommand ssh -q -W %h:%p jb
  LogLevel FATAL
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
#
# TL/DR: Do not use ssh-agent if/when possible
#        Use SSH with ProxyCommand instead wherever possible.
# SSH-AGENT issues:
#   - The ssh-agent socket name is available (without work)
#     only in the current shell.
#   - The agent does not go away on its own.
#     In fact it likes to become a zombie.
# When to use SSH-agent vs SSH-ProxyCommand
#   - https://news.ycombinator.com/item?id=9429580
# Commands:
#   eval $(ssh-agent)
#   # Remember PID
#   ssh-add ~/.ssh/id_ed25519-devops
#   ssh jb 'ssh 10.0.1.26 hostname'
#   # kill -15 <PID>

# Local dev-container
Host dev
  HostName 127.0.0.1
  User dev
  Port 2222
  LogLevel FATAL
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no

# ip a s
#   eth a4:bb:6d:67:87:3c 192.168.3.231
#   wifi bc:17:b8:64:28:b4 192.168.2.125
# ~/.ssh/id_ed25519.pub
#   ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG0flXp4pOONJfYpCRgQIMkrxpjNzfHT494myvwVXiaG pyoung@gallifrey
Host gallifrey
  HostName 192.168.3.115
  User pyoung
  Port 22
  LogLevel FATAL
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
  IdentitiesOnly yes
  IdentityFile ~/.ssh/id_ed25519
  # Forward my SSH-agent-connection so I can SSH to another host from this one (not via ProxyCommand)
  #ForwardAgent yes
#
# Manual connection to "Dev" container on gallifrey:
#   ssh -i ~/.ssh/id_ed25519    -A -J pyoung@gallifrey dev@127.0.0.1 -p 2222 "hostname&&time"
#
# Adding "ProxyCommand" below allows the above command to alows the above to be:
#   ssh gallifrey-dev "hostname&&time"
#
# dev-container on gallifrey
Host gallifrey-dev
  HostName 127.0.0.1
  IdentityFile ~/.ssh/id_ed25519
  IdentitiesOnly yes
  Port 2222
  User dev
  ProxyCommand ssh -q -W %h:%p gallifrey
  LogLevel FATAL
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
